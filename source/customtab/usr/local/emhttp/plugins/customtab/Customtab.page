Menu="Utilities"
Title="Custom Tab"
Icon="edit"
---
<?PHP
$plugin = 'customtab';
$cfg = parse_plugin_cfg($plugin);

$Credits = "
    <center><table align:'center'>
      <tr>
        <td><img src='https://github.com/Squidly271/plugin-repository/raw/master/Chode_300.gif' width='50px';height='48px'></td>
        <td><strong>Squid</strong></td>
        <td>Main Development</td>
      </tr>
    </table></center>
    <br>
    <center><a href='https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=7M7CBCVU732XG' target='_blank'><img src='https://www.paypalobjects.com/en_US/i/btn/btn_donateCC_LG.gif'></a></center>
    <br><center><a href='https://forums.lime-technology.com/topic/57109-plugin-custom-tab/' target='_blank'>Plugin Support Thread</a></center>
  ";
  $Credits = str_replace("\n","",$Credits);
?>
<script>
var URL = "/plugins/customtab/include/exec.php";

function applyTab() {
  var settings = new Array();
  for ( var index = 0; index < 100; index++ ) {
    var set = getTabSetting(index);
    settings.push(set);
  }
  $.post(URL,{action:'apply',settings:JSON.stringify(settings)},function(data) {
    if ( data ) {
      location.reload();
    }
  });
}

function showCredits() {
  myAlert("Custom Tab","<?=$Credits?>","/plugins/customtab/images/customlarge.png","96x96", true, false, true);
}

function myAlert(description,textdescription,textimage,imagesize, outsideClick, showCancel, showConfirm, alertType) {
  if ( !outsideClick ) outsideClick = false;
  if ( !showCancel )   showCancel = false;
  if ( !showConfirm )  showConfirm = false;
  if ( imagesize == "" ) { imagesize = "80x80"; }
  swal({
    title: description,
    text: textdescription,
    imageUrl: textimage,
    imageSize: imagesize,
    allowOutsideClick: outsideClick,
    showConfirmButton: showConfirm,
    showCancelButton: showCancel,
    type: alertType,
    html: true
  });
}

function getTabSetting(index) {
  var tabname = $("#customtabname" + index).val();
  var fullname = $("#fullname" + index).val();
  var url = $("#url" + index).val();
  var width = $("#width" + index).val();
  var height = $("#height" + index).val();
  var fontawesome = $("#fontawesome" + index).val();
  var selectPage = $("#selectPage"+index).val();
  var page = $("#page"+index).val();
	var position = $("#position"+index).val();
  var set = new Array(tabname,fullname,url,width,height,fontawesome,selectPage,page,position);
  return set;
}

function addTab() {
  var settings = new Array();
  for ( var index = 0; index < 100; index++ ) {
    var set = getTabSetting(index);
    settings.push(set);
  }
  showTabs("add_tab",settings);
}  

function deleteTab(del) {
  var settings = new Array();
  for ( var index = 0; index < 100; index++ ) {
    if ( index == del ) {
      continue;
    }
    var set = getTabSetting(index);
    settings.push(set);
  }
  showTabs("show_tabs",settings);
  $("#myapply").prop("disabled",false);
}
    

function showTabs(action,settings) {
  $.post(URL,{action:action,settings:JSON.stringify(settings)},function(data) {
    if (data) {
      $("#settings").html(data);
      $(".setting").change(function() {
        $("#myapply").prop("disabled",false);
      });
      $(".url").change(function() {
        checkURL();
      });
    }
  });
}

function checkURL() {
  var flag = false;
  $(".url").each(function() {
    var value = $(this).val();
    if ( ! value ) {
      $("#newtab").prop("disabled",true);
      flag = true;
    }
  });
  if ( ! flag ) {
    $("#newtab").prop("disabled",false);
  }
}

function enablePage(index) {
  var pageEnable = $("#selectPage"+index).val();
	switch (pageEnable) {
		case "page":
		  $(".url"+index).prop("disabled",true);
			$(".page"+index).prop("disabled",false);
			break;
		case "url":
			$(".url"+index).prop("disabled",false);
			$(".page"+index).prop("disabled",true);
			$(".bookmark"+index).prop("disabled",false);
			break;
		case "bookmark":
			$(".url"+index).prop("disabled",false);
			$(".page"+index).prop("disabled",true);
			$(".bookmark"+index).prop("disabled",true);
			break;
	
  }
}
  
$(function() {
  $.post(URL,{action:'get_tabs_init'},function(data) {
    if (data) {
      $("#settings").html(data);
      $(".setting").change(function() {
        $("#myapply").prop("disabled",false);
      });
      $(".url").change(function() {
        checkURL();
      });
    }
  });
});

</script>
<font size='2'><strong>NOTE: </strong></font>  If you access your server via HTTPS, then any custom tab added using a URL <b>must</b> also use HTTPS.<br><br>
<span id='settings'></span>

<input id='myapply' type="button" value="Apply" onclick='applyTab();'><input type="button" value="Done" onclick="done()">
</form>
<a class='ca_credits' style='float:right;cursor:pointer' onclick='showCredits();'>Credits</a>
<span id='debug'></span>
<input type='button' value='Add Another Tab' id='newtab' onclick='addTab();'>